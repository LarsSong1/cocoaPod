{% load static %}
{% load tailwind_filters %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detector de humedad</title>
    {% include "components/tailwind.html" %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://prod.spline.design/xcOlWmcbKWpq7vp1/scene.splinecode">
</head>
<body class="h-screen" onload="fetchSensorData()">
    {% include "components/header.html" %}

    <main class="h-[calc(100vh-120px)] w-full absolute top-14">

        {% include "components/aside.html" %}
        <section id="content"
            class="w-[100wh-60px] lg:w-[100wh-250px] ml-[60px] lg:ml-[240px] p-5 right-0 transition-all duration-500 ease-in-out h-full">

            
            <h1 class="ps-2 text-2xl font-bold z-20">Detector de Humedad </h1>
            <div class=" grid place-content-center h-full relative overflow-hidden min-h-[600px]">
                <script type="module" src="https://unpkg.com/@splinetool/viewer@1.3.8/build/spline-viewer.js"></script>
                <spline-viewer class="w-[0] hidden md:block h-[0] md:w-[80vw] md:h-[80vh]" url="https://prod.spline.design/xcOlWmcbKWpq7vp1/scene.splinecode"></spline-viewer>
                


                <div class="absolute lg:right-[20vw] lg:top-[15vh] mt-6 flex w-96 flex-col rounded-xl bg-white bg-clip-border text-gray-700 shadow-md">
                    <div class="p-6">
                        <i class="fa-droplet fa-solid text-blue-800 text-6xl"></i>
                        <h5 class="mb-2 mt-4 block font-sans text-2xl font-bold leading-snug tracking-normal text-blue-gray-900 antialiased">
                        Detector de Humedad en el suelo en tiempo real
                        </h5>
                        <p id="sensor-data" class="block text-8xl font-sans text-end font-bold leading-relaxed  text-blue-800 antialiased">
                            
                        </p>
                    </div>
                    <div class="p-6 pt-0 font-semibold">
                       <p>Datos vienen de Arduino</p>
                    </div>

           


            </div>
        
            
        </section>

    </main>


    {% include "components/dashscripts.html" %}


    {% comment %} <script>
        function fetchSensorData() {
            fetch('/sensor-data/')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('sensor-data').innerText =  data.humidity;
                })
                .catch(error => console.error('Error fetching sensor data:', error));
        }

        setInterval(fetchSensorData, 1000);  // Actualizar cada segundo
    </script> {% endcomment %}

    <script>
        function fetchSensorData() {
            fetch('/detect-humidity/', {
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('sensor-data').innerText =  data.humidity;
            })
            .catch(error => console.error('Error fetching sensor data:', error));
        }

        setInterval(fetchSensorData, 2000);  // Actualizar cada 2 segundos
    </script>
</body>
</html>